# 服务器打包说明

## 📦 打包步骤

### 方法1：使用批处理脚本（推荐）

双击运行：`打包服务器.bat`

### 方法2：手动打包

```powershell
# 1. 激活虚拟环境
.\.venv\Scripts\Activate.ps1

# 2. 安装PyInstaller（如果还没安装）
pip install pyinstaller

# 3. 打包
pyinstaller --name="失物招领系统-服务器" --onefile --console --add-data "app;app" --hidden-import=flask --hidden-import=werkzeug --hidden-import=sqlalchemy --hidden-import=flask_cors --hidden-import=app.main --hidden-import=app.web --hidden-import=app.database --hidden-import=app.auth --hidden-import=app.agent --collect-all flask --collect-all werkzeug build_exe.py
```

## 📁 打包结果

打包完成后，EXE文件位于：`dist\失物招领系统-服务器.exe`

## 🚀 使用方法

1. **双击运行** `dist\失物招领系统-服务器.exe`
2. **命令行窗口会显示**：
   ```
   ============================================================
   校园失物招领系统 - 服务器
   ============================================================
   服务器地址: http://0.0.0.0:5000
   本地访问: http://localhost:5000
   局域网访问: http://你的IP:5000
   
   服务器运行中...
   按 Ctrl+C 停止服务器
   ============================================================
   ```
3. **保持窗口打开**，不要关闭
4. **客户端可以连接到服务器的IP地址**

## ⚙️ 注意事项

1. **防火墙**：可能需要允许5000端口
2. **IP地址**：如果IP变化，需要告知客户端更新服务器地址
3. **数据库**：数据库文件 `database.db` 会保存在exe同目录下

## 🔧 故障排查

### 问题1：打包失败
- 检查虚拟环境是否激活
- 检查是否安装了所有依赖：`pip install -r requirements.txt`

### 问题2：运行exe报错
- 检查是否有 `database.db` 文件（会自动创建）
- 检查端口5000是否被占用
- 查看 `error.log` 文件获取详细错误信息

### 问题3：客户端无法连接
- 检查服务器是否已启动
- 检查防火墙设置
- 检查服务器IP地址是否正确

---

**打包完成后，将 `dist\失物招领系统-服务器.exe` 分发给需要运行服务器的用户。**

