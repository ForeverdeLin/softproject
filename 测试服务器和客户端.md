# 测试服务器和客户端 - 快速指南

## 📋 测试步骤

### 第一步：检查依赖

在项目根目录（`softProject`）打开终端，运行：

```powershell
# 检查是否已安装依赖
pip list | findstr "Flask SQLAlchemy flask-cors requests"
```

如果没有安装，运行：
```powershell
pip install -r requirements.txt
```

---

### 第二步：启动服务器

**打开第一个终端窗口**，运行：

```powershell
cd D:\0To300Ins\softProject
python -m app.main
```

**成功启动后，你会看到类似输出：**
```
 * Serving Flask app 'app.main'
 * Debug mode: on
WARNING: This is a development server. Do not use it in a production deployment.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.x.x:5000
Press CTRL+C to quit
```

**⚠️ 保持这个终端窗口打开，不要关闭！**

---

### 第三步：测试客户端（方法1 - 使用测试脚本）

**打开第二个终端窗口**（保持第一个窗口的服务器运行），运行：

```powershell
cd D:\0To300Ins\softProject
python scripts\test_api_client.py
```

**预期输出：**
```
==================================================
API客户端测试工具
==================================================
服务器地址: http://localhost:5000

✅ 服务器连接正常

=== 测试：获取所有失物列表 ===
✅ 成功获取 X 条失物信息
  ...

=== 测试：获取所有招领列表 ===
✅ 成功获取 X 条招领信息
  ...
```

---

### 第四步：测试客户端（方法2 - 使用浏览器）

在浏览器中访问以下URL：

1. **获取所有失物：**
   ```
   http://localhost:5000/api/lost
   ```

2. **获取所有招领：**
   ```
   http://localhost:5000/api/found
   ```

3. **Web界面首页：**
   ```
   http://localhost:5000/
   ```

---

### 第五步：测试客户端（方法3 - 使用curl命令）

在PowerShell中运行：

```powershell
# 获取所有失物
curl http://localhost:5000/api/lost

# 获取所有招领
curl http://localhost:5000/api/found
```

---

## 🔍 常见问题

### Q1: 端口被占用？
**错误信息：** `Address already in use`

**解决方法：**
1. 找到占用5000端口的进程：
   ```powershell
   netstat -ano | findstr :5000
   ```
2. 结束进程或修改端口（在 `app/main.py` 中修改 `port=5000`）

---

### Q2: 模块找不到？
**错误信息：** `ModuleNotFoundError: No module named 'flask'`

**解决方法：**
```powershell
pip install -r requirements.txt
```

---

### Q3: 数据库错误？
**错误信息：** 数据库相关错误

**解决方法：**
删除 `database.db` 文件，重新运行服务器会自动创建

---

### Q4: 客户端连接失败？
**错误信息：** `无法连接到服务器`

**检查：**
1. 服务器是否已启动？（第一个终端窗口是否还在运行？）
2. 服务器地址是否正确？（默认是 `http://localhost:5000`）
3. 防火墙是否阻止了连接？

---

## ✅ 测试检查清单

- [ ] 依赖已安装（Flask, SQLAlchemy, flask-cors, requests）
- [ ] 服务器成功启动（看到 "Running on http://..."）
- [ ] 客户端测试脚本运行成功
- [ ] 浏览器可以访问 API 接口
- [ ] 可以获取失物和招领数据

---

## 🎯 完整测试流程示例

```powershell
# 终端1：启动服务器
cd D:\0To300Ins\softProject
python -m app.main

# 终端2：运行客户端测试（在另一个终端）
cd D:\0To300Ins\softProject
python scripts\test_api_client.py

# 浏览器：访问
# http://localhost:5000/api/lost
# http://localhost:5000/api/found
```

---

**提示：** 测试完成后，按 `Ctrl+C` 停止服务器。

