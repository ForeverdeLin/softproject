# 数据库查看说明

## 📊 当前数据库存储的内容

**注意：当前系统没有记录访问日志，数据库中存储的是业务数据：**

1. **users** - 用户表
   - 用户ID、学号、姓名、邮箱、电话、密码哈希、创建时间

2. **lost_items** - 失物表
   - 失物ID、用户ID、物品名称、类别、丢失地点、丢失时间、描述、颜色、品牌、是否已解决

3. **found_items** - 招领表
   - 招领ID、用户ID、物品名称、类别、拾获地点、拾获时间、描述、颜色、品牌、是否已解决

4. **match_records** - 匹配记录表
   - 匹配ID、失物ID、招领ID、匹配分数、匹配原因、是否已通知、创建时间

5. **notifications** - 通知表
   - 通知ID、用户ID、通知类型（match/reminder/announcement）、标题、内容、相关物品ID、相关匹配ID、是否已读、创建时间

---

## 🔍 查看数据库的方法

### 方法1：使用Python脚本（推荐，最简单）

**运行查看脚本：**
```powershell
.\.venv\Scripts\Activate.ps1
python 查看数据库.py
```

**输出内容：**
- 所有用户信息
- 所有失物信息
- 所有招领信息
- 所有匹配记录
- 所有通知记录
- 统计信息

---

### 方法2：使用SQLite命令行工具

**打开SQLite命令行：**
```powershell
sqlite3 database.db
```

**常用命令：**
```sql
-- 查看所有表
.tables

-- 查看用户表
SELECT * FROM users;

-- 查看失物表
SELECT * FROM lost_items;

-- 查看招领表
SELECT * FROM found_items;

-- 查看匹配记录
SELECT * FROM match_records ORDER BY match_score DESC;

-- 查看通知记录
SELECT * FROM notifications ORDER BY created_at DESC;

-- 查看未读通知
SELECT * FROM notifications WHERE is_read = 0 ORDER BY created_at DESC;

-- 退出
.quit
```

---

### 方法3：使用图形化工具（推荐，最直观）

#### 选项A：DB Browser for SQLite（免费）
1. 下载：https://sqlitebrowser.org/
2. 安装后打开
3. 打开数据库文件：`database.db`
4. 可以查看所有表和数据，支持SQL查询

#### 选项B：VS Code插件
1. 安装插件：SQLite Viewer 或 SQLite
2. 在VS Code中打开 `database.db` 文件
3. 可以查看和编辑数据

#### 选项C：在线工具
- https://sqliteviewer.app/
- 上传 `database.db` 文件即可查看

---

### 方法4：使用Python交互式查看

```powershell
.\.venv\Scripts\Activate.ps1
python
```

```python
from app.database.db_manager import DatabaseManager
from app.database import models_db

db_manager = DatabaseManager()
session = db_manager.get_session()

# 查看所有用户
users = session.query(models_db.UserDB).all()
for user in users:
    print(f"ID: {user.id}, 学号: {user.student_id}, 姓名: {user.name}")

# 查看所有失物
lost_items = session.query(models_db.LostItemDB).all()
for item in lost_items:
    print(f"ID: {item.id}, 物品: {item.item_name}, 地点: {item.lost_location}")

session.close()
```

---

## 📝 关于访问记录

**当前系统没有记录访问日志**，如果需要记录访问记录，可以：

### 方案1：添加访问日志表（如果需要）

可以添加一个 `access_logs` 表，记录：
- 访问时间
- 访问IP
- 访问路径
- 用户ID（如果已登录）

### 方案2：使用Flask日志（简单）

Flask会自动记录请求到控制台，但不会存到数据库。

---

## 🧪 快速测试

**运行查看脚本：**
```powershell
.\.venv\Scripts\Activate.ps1
python 查看数据库.py
```

应该能看到所有数据，包括：
- 你注册的用户
- 发布的失物/招领
- 智能体生成的匹配记录
- 通知智能体生成的通知记录

---

## 💡 推荐方式

**最简单：** 运行 `python 查看数据库.py`  
**最直观：** 使用 DB Browser for SQLite（图形化工具）  
**最灵活：** 使用SQLite命令行或Python交互式

---

**现在可以运行 `python 查看数据库.py` 查看所有数据了！** 🎉

